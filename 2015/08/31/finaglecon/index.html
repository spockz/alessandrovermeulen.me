
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>FinagleCon - Alessandro Vermeulen</title>
  <meta name="author" content="Alessandro Vermeulen">

  
  <meta name="description" content="FinagleCon was held at TwitterHQ in San Francisco. It is refreshing to see a
nice working atmosphere with free food and drinks. Now for the contents &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://alessandrovermeulen.me/2015/08/31/finaglecon">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <!--<script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>-->
  <link href="/atom.xml" rel="alternate" title="Alessandro Vermeulen" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"> -->
<!-- <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"> -->
<!-- <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script> -->
<link href='http://fonts.googleapis.com/css?family=Open+Sans|Droid+Serif' rel='stylesheet' type='text/css'>

</head>

<body   >

  <section class="container">
    <header role="banner"><hgroup>
  <header id="pageheader">
    <header role="banner" id="banner">
      <h1><a href="/">Alessandro Vermeulen</a></h1>
      
        <p>Alessandro Vermeulen's blog about languages, programming, Computer Science, photography and the Web. <a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><i class="icon-rss"></i></a></p>
      
    </header>
  </header>
</hgroup>

</header>
    <nav role="navigation"><nav class="navbar">
  <ul class="nav nav-pills">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


  <ul class="pull-right subscription nav nav-pills" data-subscription="rss">
  
  </ul>

  <form class="navbar-search pull-right" action="http://google.com/search" method="get">
  <fieldset role="search" id="searchfieldset">
    <input type="hidden" name="q" value="site:alessandrovermeulen.me" />

    <div class="input-append">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <button type="submit" class="btn"><i class="icon-search"></i></button>
    </div>
  </fieldset>
  </form>
</nav>
<!--
<ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:alessandrovermeulen.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

 --></nav>
    <!--[if lt IE 9]>
    <div class="alert alert-block">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <h4>Warning!</h4>
      Your version of Internet Explorer is seriously outdated. Please upgrade to a decent version of <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">Internet Explorer</a> or <a href="http://www.google.com/chrome">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>.
    </div>
    <![endif]-->
    <div id="main">
      <div id="content">
        <div class="row-fluid">
  <div class="span9">
  <article class="hentry" role="article">
    
  <header>
    
      <h1 class="entry-title">FinagleCon</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-31T17:57:00+00:00" pubdate data-updated="true">Aug 31<span>st</span>, 2015</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>FinagleCon was held at TwitterHQ in San Francisco. It is refreshing to see a
nice working atmosphere with free food and drinks. Now for the contents.</p>

<p>Twitter’s RPC framework, Finagle, has been in production since <a href="http://vkostyukov.ru/slides/finch-101/?full#5">August
2010</a> and has over 140
contributors. In addition to Twitter, it has been adopted by many large
companies such as SoundCloud. Initially written in Java with FP constructs
(monads, maps, etc.) all over, it was soon after rewritten in Scala.</p>

<p>Finagle is based on three core concepts: Simplicity, Composability, and
Separation of Concerns. These concepts are shown through three primitive
building blocks:
<a href="https://twitter.github.io/util/docs/index.html#com.twitter.util.Future"><code>Future</code></a>,
<a href="https://twitter.github.io/finagle/docs/index.html#com.twitter.finagle.Service"><code>Service</code></a>,
and
<a href="https://twitter.github.io/finagle/docs/index.html#com.twitter.finagle.Filter"><code>Filter</code></a>.</p>

<ul>
  <li><code>Future</code>s provide an easy interface to create asynchronous computation and
to model sequential or asynchronous data-flows.</li>
  <li><code>Service</code>s are functions that return futures, used to abstract away, possibly
remote, service calls.</li>
  <li><code>Filter</code>s are essentially decorators and are meant to contain modular blocks
of re-usable, non-business logic. Example usages are <a href="https://twitter.github.io/finagle/docs/index.html#com.twitter.finagle.filter.LoggingFilter">LoggingFilter</a> and
<a href="https://twitter.github.io/finagle/docs/index.html#com.twitter.finagle.service.RetryingFilter">RetryingFilter</a>.</li>
</ul>

<p>The use of Futures makes it easy to test asynchronous computations. Services and
filters both can be created separately, each containing their specialized logic.
This modularity makes it easy to test and reason about them separately. Services
and filters are easily composed, just like functions do, which makes it
convenient to test chains. Services and filters are meant to separate behaviour
from domain logic.</p>

<p>As amazing as Finagle is, there are some things one should be aware of. To
create a really resilient application with Finagle one has to be an expert in
its internals. Many configuration parameters influence each other, e.g. queue
size and time-outs. With a properly tuned setup Finagle is properly fast and
resilient (the defaults are good as well, mind you). As most data centres are
heterogenous in their setup, faster machines are added to the pool, and other
conditions change, one has to keep attention to the tuning continuously in order
to maintain optimal performance.</p>

<p>Some general advice, watch out for traffic amplification due to retries, keep
your timeouts low so retry is useful, but not as low that you introduce spurious
timeouts.</p>

<p>For extra points, keep hammering your application until it breaks, find out why
it breaks, fix it, and repeat.</p>

<h2 id="the-future">The future</h2>

<p>In addition to this heads up we were also given a nice insight in the upcoming
things for Finagle.</p>

<p>In order to make more informed decision, we will get a new Failure type which
contains more information instead of ‘just’ a <code>Throwable</code>. In this new
<code>Failure</code>, an added field indicates whether it is safe to <code>retry</code>.</p>

<p>There are several issues with the current way of fine-tuning Finagle, as
mentioned, you need to be an expert to use all the configuration parameters
properly. Next to this the configuration is static and doesn’t take into account
changing environments and behaviour of downstream services. Because the tuning
of the parameters is tightly coupled with the implementation of Finagle it is
also hard to change the implementation significantly without significant
re-tuning.</p>

<p>In order to battle the last two points, Finagle will introduce Service Level
Objectives (SLO). The SLO is a higher-level goal that Finagle should strive to
reach instead of low-level hardcoded parameters. What these SLO will be exactly
is not yet known.</p>

<h2 id="the-community">The community</h2>

<p>The Finagle team will synchronize the internal Finagle repository with the
Github repository every Monday. They will strive to publish a snapshot version
of the change as well.</p>

<p>For someone looking to write his own protocol to connect to his service,
<code>finagle-serial</code> is a nice project to start with. It is small enough to grasp
within a day but big enough to be non-trivial.</p>

<p>It was found that the
<a href="http://blog.ragozin.info/2012/03/secret-hotspot-option-improving-gc.html">ParGCCardsPerStrideChunk</a>
garbage collection option, available from 7u40, can halve GC times on large
heaps. It is recommended to try this parameter. Tuning seems to be hard to do
and is generally done by copying a ‘known good set’ of parameters.</p>

<p><a href="http://twitter.github.io/scrooge/">Scrooge</a> is a good utility to use for Thrift
and Scala as it is aware of Scala features such as Traits and Objects and can
generate relevant transformations for them.</p>

<p>When you want to connect to multiple data-centres from a single data-centre one
can use
<a href="https://twitter.github.io/finagle/docs/index.html#com.twitter.finagle.client.LatencyCompensation$">LatencyCompensation</a>
to include latency times.</p>
</div>


    <footer>
      <p class="meta">
        
  

<span class="byline author vcard">Posted by <span class="fn"><a rel="author" href="https://plus.google.com/103782975895345685833">Alessandro Vermeulen</a></span></span>

        








  


<time datetime="2015-08-31T17:57:00+00:00" pubdate data-updated="true">Aug 31<span>st</span>, 2015</time>
        

<span class="categories">
  
    <a class='category' href='/blog/categories/programming/'>Programming</a>, <a class='category' href='/blog/categories/software/'>Software</a>
  
</span>


      </p>
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://alessandrovermeulen.me/2015/08/31/finaglecon/" data-via="" data-counturl="http://alessandrovermeulen.me/2015/08/31/finaglecon/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

      
      <p class="meta">
        
          <a class="basic-alignment left" href="/2014/12/04/orchestration-support-announced-on-dockercon/" title="Previous Post: Orchestration support announced on DockerCon">&laquo; Orchestration support announced on DockerCon</a>
        
        
      </p>
    </footer>
  </article>
  
    <section>
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
  
  </div>
  
  <aside class="sidebar span3">
    
      <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts" class="unstyled">
    
      <li class="post">
        <a href="/2015/08/31/finaglecon/">FinagleCon</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/04/orchestration-support-announced-on-dockercon/">Orchestration support announced on DockerCon</a>
      </li>
    
      <li class="post">
        <a href="/2014/07/15/notes-on-the-advanced-akka-course/">Notes on the Advanced Akka course</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/13/the-difference-between-shallow-and-deep-embedding/">The difference between shallow and deep embedding</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/08/combining-graphviz-dot-and-tikz-with-dot2tex/">Combining graphviz (dot) and TikZ with dot2tex</a>
      </li>
    
  </ul>
</section>




<section class="tag-cloud">
  <h1>Tags</h1>
  <span class='rank-4'><a href='/tags/Scala'>Scala</a></span> <span class='rank-5'><a href='/tags/cabal'>cabal</a></span> <span class='rank-5'><a href='/tags/layout'>layout</a></span> <span class='rank-4'><a href='/tags/css'>css</a></span> <span class='rank-4'><a href='/tags/lhs2tex'>lhs2tex</a></span> <span class='rank-5'><a href='/tags/lenny'>lenny</a></span> <span class='rank-5'><a href='/tags/Web'>Web</a></span> <span class='rank-5'><a href='/tags/debian'>debian</a></span> <span class='rank-5'><a href='/tags/Haskell-platform'>Haskell platform</a></span> <span class='rank-4'><a href='/tags/partial'>partial</a></span> <span class='rank-4'><a href='/tags/mvc'>mvc</a></span> <span class='rank-5'><a href='/tags/type-algebra'>type algebra</a></span> <span class='rank-5'><a href='/tags/uuagc'>uuagc</a></span> <span class='rank-5'><a href='/tags/syntax-highlighting'>syntax highlighting</a></span> <span class='rank-3'><a href='/tags/open-source'>open source</a></span> <span class='rank-5'><a href='/tags/hackage'>hackage</a></span> <span class='rank-5'><a href='/tags/attribute-grammars'>attribute grammars</a></span> <span class='rank-4'><a href='/tags/TikZ'>TikZ</a></span> <span class='rank-5'><a href='/tags/com'>com</a></span> <span class='rank-5'><a href='/tags/orm'>orm</a></span> <span class='rank-4'><a href='/tags/textmate'>textmate</a></span> <span class='rank-3'><a href='/tags/codeigniter'>codeigniter</a></span> <span class='rank-5'><a href='/tags/Akka'>Akka</a></span> <span class='rank-4'><a href='/tags/LaTeX'>LaTeX</a></span> <span class='rank-4'><a href='/tags/php'>php</a></span> <span class='rank-5'><a href='/tags/Software'>Software</a></span> <span class='rank-4'><a href='/tags/doctrine'>doctrine</a></span> <span class='rank-3'><a href='/tags/lhs2tex-hl'>lhs2tex-hl</a></span> <span class='rank-5'><a href='/tags/ghc'>ghc</a></span> <span class='rank-5'><a href='/tags/web'>web</a></span> <span class='rank-4'><a href='/tags/xhtml'>xhtml</a></span> <span class='rank-5'><a href='/tags/applescript'>applescript</a></span> <span class='rank-4'><a href='/tags/rss'>rss</a></span> <span class='rank-5'><a href='/tags/html5'>html5</a></span> <span class='rank-4'><a href='/tags/partials'>partials</a></span> <span class='rank-5'><a href='/tags/JavaScript'>JavaScript</a></span> <span class='rank-5'><a href='/tags/colour'>colour</a></span> <span class='rank-5'><a href='/tags/os-x'>os x</a></span> <span class='rank-4'><a href='/tags/Graphviz'>Graphviz</a></span> <span class='rank-1'><a href='/tags/Haskell'>Haskell</a></span> <span class='rank-4'><a href='/tags/fold'>fold</a></span> <span class='rank-5'><a href='/tags/Finagle'>Finagle</a></span> <span class='rank-5'><a href='/tags/Docker'>Docker</a></span> <span class='rank-5'><a href='/tags/delphi-2009'>delphi 2009</a></span> 
</section>
<section>
  <h1>About Me</h1>
  <p>Alessandro Vermeulen is a Functional Programming enthousiast and Computer Sciences MSc
     alumnus from Utrecht University. His thesis was on incremental evaluation of Haskell programs.</p>
</section>
<section>
  <h1>Blogroll</h1>
  <ul class="unstyled">
    <li class="nav-header">Friends</li>
    <li><a href="http://blog.timmybankers.nl">Tim Soethout</a></li>
    <li><a href="https://thijsalkema.de/blog/">Thijs Alkemade</a></li>
    <li><a href="http://www.norm2782.com/">Jurriën Stutterheim</a></li>
  </ul>

  <ul class="unstyled">
    <li class="nav-header">Interesting Companies</li>
    <li><a href="https://typesafe.com" rel="nofollow">Typesafe</a></li>
    <li><a href="http://www.binksoftware.nl/" rel="nofollow">BINK software B.V.</a></li>
  </ul>

  <ul class="unstyled">
    <li class="nav-header">Personal</li>
    <li><a href="http://www.linkedin.com/in/alessandrovermeulen" rel="nofollow">LinkedIn</a></li>
  </ul>
</section>

    
  </aside>
  
</div>
      </div>
    </div>
    <footer role="contentinfo" id="pagefooter"><p>
  Copyright &copy; 2015 - Alessandro Vermeulen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
<script src="http://hyphenator.googlecode.com/svn/tags/Version%203.2.0/Hyphenator.js?bm=true" type="text/javascript"></script>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'alessandrovermeulen';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://alessandrovermeulen.me/2015/08/31/finaglecon/';
        var disqus_url = 'http://alessandrovermeulen.me/2015/08/31/finaglecon/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
<!-- <script type="text/javascript">
$(document).ready(function() {
  $('#disqus_thread').disqus({
    domain:     "alessandrovermeulen",
    title:      document.title,
    developer:  window.location.hostname == "localhost" ? 1 : 0,
    show_count: true,
    prettify:   true,
    markdown:   true,
    //iframe_css: "http://somewhere.com/stylesheets/disqus.css",
    ready: function() {
      // this is when your disqus comments finally load
      console.log("Comment count: " + $.disqus.commentCount().toString());
      console.log("Reaction count: " + $.disqus.reactionCount().toString());
    },
    added: function(comments) {
      // do something with the newly added comment divs.
    },
    edit: function(textarea) {
      // called when someone clicks the "reply" button.
    }
  });
});
</script> -->





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </section>

  
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-9190312-1', 'auto');
    ga('send', 'pageview');
  </script>


  <script src="/javascripts/modernizr-2.0.js" type="text/javascript"></script>
  <script src="/javascripts/jquery-1.10.2.min.js" type="text/javascript"></script>
  <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
  <script src="/javascripts/photography.js" type="text/javascript"></script>
  <!-- mathjax config similar to math.stackexchange -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$']],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    messageStyle: "none",
    "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
  </script>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

</body>
</html>
